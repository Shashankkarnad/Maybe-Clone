<%# locals: (entry:) %>

<%= styled_form_with model: [entry.account, entry],
                     data:  { turbo_frame: "_top" },
                     url:   entry.new_record? ? account_entries_path(entry.account) : account_entry_path(entry.account, entry) do |form| %>
  <div class="space-y-4">
    <div class="space-y-2">
      <%= form.select :type, options_for_select([%w[Buy buy], %w[Sell sell]], "buy"), label: t(".type") %>

      <%= form.fields_for :entryable do |ff| %>
        <%= ff.text_field :ticker, value: nil, label: t(".holding"), placeholder: "Enter ticker symbol" %>
      <% end %>

      <%= form.date_field :date, label: true %>

      <%= form.hidden_field :entryable_type, value: entry.entryable_type %>
      <%= form.hidden_field :currency, value: entry.account.currency %>

      <%= form.fields_for :entryable do |ff| %>
        <%= ff.number_field :qty, label: t(".qty"), placeholder: "10" %>
        <%= money_with_currency_field ff, :price_money, label: t(".price"), disable_currency: true %>
        <%= ff.hidden_field :currency, value: entry.account.currency %>
      <% end %>
    </div>

    <%= form.submit t(".submit") %>
  </div>
<% end %>
